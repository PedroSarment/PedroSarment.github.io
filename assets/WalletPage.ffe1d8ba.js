import{_ as h,o as a,i as c,g as t,t as l,j as P,q as x,s as $,n as k,b as m,f as p,aC as V,m as w,k as d,F as S,c as F,l as b}from"./index.a99d2ae6.js";import{P as I}from"./ProfileComponent.1b8cd582.js";import{Q as v}from"./QInput.0da39cad.js";import"./use-dark.7d681600.js";import"./uid.42677368.js";import"./focus-manager.05708ea9.js";import"./use-form.49964318.js";const q={name:"TransactionCard",props:{title:String,price:Number,customer:String},computed:{formatPrice(){return this.price.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},calculatePercentage(){return(this.price*.3).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}}},T=e=>(x("data-v-6b2c70d6"),e=e(),$(),e),N={class:"container"},E={class:"transaction-infos flex"},H=T(()=>t("img",{src:"/../icons/money.svg",alt:"Money Icon"},null,-1)),R={class:"transaction"},j={class:"transaction-name"},A={class:"transaction-value"},L={class:"platform-value"},M=T(()=>t("span",null,"Plataforma Pontea",-1)),z={class:"transaction-receiver"};function Q(e,o,n,r,s,i){return a(),c("div",N,[t("div",E,[H,t("section",R,[t("p",j,l(n.title),1),t("p",A,"R$ "+l(i.formatPrice),1),t("p",L,[P(" -R$ "+l(i.calculatePercentage)+" ",1),M]),t("p",z,l(n.customer),1)])])])}var U=h(q,[["render",Q],["__scopeId","data-v-6b2c70d6"]]);const W={name:"BalanceComponent",props:{date:Date,totalPrice:Number},methods:{formatDate(e){const o=new Date(e),n=String(o.getDate()).padStart(2,"0"),r=String(o.getMonth()+1).padStart(2,"0"),s=o.getFullYear(),i=String(o.getHours()).padStart(2,"0"),u=String(o.getMinutes()).padStart(2,"0");return`${r}/${n}/${s} ${i}:${u}`}}},G={class:"container"},Y={class:"date"},J={class:"balance"};function K(e,o,n,r,s,i){return a(),c("div",G,[t("p",Y,l(n.date),1),t("p",J,[P(" Saldo do dia: "),t("span",null,"R$"+l(n.totalPrice),1)])])}var O=h(W,[["render",K],["__scopeId","data-v-ed142e66"]]);const X={name:"StepCircle",props:{step:{type:Number,required:!0},label:{type:String,required:!0},currentStep:{type:Number,required:!0},completedStep:{type:Boolean,required:!0}}},Z={class:"label-step"};function ee(e,o,n,r,s,i){return a(),c("div",{class:k(["circle",{"current-color":n.currentStep>=n.step,"completed-step":n.completedStep==!0}])},[t("span",null,l(n.step),1),t("p",Z,l(n.label),1)],2)}var te=h(X,[["render",ee],["__scopeId","data-v-61c57c84"]]);const oe={name:"StepComponent",props:{currentStep:Number},components:{StepCircle:te}},ne={class:"container"};function se(e,o,n,r,s,i){const u=m("StepCircle");return a(),c("div",ne,[p(u,{step:1,label:"Conta para transfer\xEAncia",currentStep:n.currentStep,completedStep:n.currentStep>=2},null,8,["currentStep","completedStep"]),t("div",{class:k(["line",{"line-color":n.currentStep>=1}])},null,2),p(u,{step:2,label:"Transfer\xEAncia conclu\xEDda",currentStep:n.currentStep,completedStep:n.currentStep>=2},null,8,["currentStep","completedStep"])])}var re=h(oe,[["render",se],["__scopeId","data-v-eba23052"]]);const ae={name:"TransferComponent",data(){return{currentStep:1,code:"",agency:"",account:""}},components:{StepComponent:re},methods:{async submitForm(){const e="api/removeCredit",o=localStorage.getItem("token"),n={"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${o}`};await fetch(e,{method:"GET",headers:n}).then(r=>{if(!r.ok)throw console.log(r.json()),new Error("Erro na resposta da API");return r.json()}).then(()=>{this.currentStep++,this.code="",this.agency="",this.account="",setTimeout(()=>{this.$router.push({name:"HomePage"})},1e3)}).catch(r=>{console.error("Erro na solicita\xE7\xE3o \xE0 API:",r)})}},props:{}},f=e=>(x("data-v-7ea21467"),e=e(),$(),e),ce={class:"wrap"},ie={class:"field"},le=f(()=>t("label",null,"C\xF3digo do Banco",-1)),pe={class:"field"},ue=f(()=>t("label",null,"Ag\xEAncia",-1)),_e={class:"field"},de=f(()=>t("label",null,"Conta corrente",-1)),me={key:0,class:"success"},he=f(()=>t("h3",{class:"success-title"},"Saldo transferido com sucesso!",-1)),fe=f(()=>t("p",{class:"success-message"}," Em at\xE9 72h seu saldo estar\xE1 disponivel na conta solicitada. ",-1)),ge=[he,fe];function ye(e,o,n,r,s,i){const u=m("StepComponent");return a(),c(S,null,[t("div",ce,[p(u,{currentStep:s.currentStep},null,8,["currentStep"]),s.currentStep===1?(a(),c("form",{key:0,class:"form",onSubmit:o[3]||(o[3]=V(_=>i.submitForm(),["prevent"]))},[t("div",ie,[le,p(v,{type:"number",name:"code",modelValue:s.code,"onUpdate:modelValue":o[0]||(o[0]=_=>s.code=_),outlined:"",dense:"",required:"",class:"input bg-input"},null,8,["modelValue"])]),t("div",pe,[ue,p(v,{type:"number",name:"agency",modelValue:s.agency,"onUpdate:modelValue":o[1]||(o[1]=_=>s.agency=_),outlined:"",dense:"",required:"",class:"input bg-input"},null,8,["modelValue"])]),t("div",_e,[de,p(v,{type:"number",name:"account",modelValue:s.account,"onUpdate:modelValue":o[2]||(o[2]=_=>s.account=_),outlined:"",dense:"",required:"",class:"input"},null,8,["modelValue"])]),p(w,{class:"q-px-xl q-py-sm transfer-btn",label:"Transferir",type:"submit",color:"primary"})],32)):d("",!0)]),s.currentStep===2?(a(),c("div",me,ge)):d("",!0)],64)}var ve=h(ae,[["render",ye],["__scopeId","data-v-7ea21467"]]);const Se={name:"WalletPage",components:{ProfileComponent:I,TransactionCard:U,BalanceComponent:O,TransferComponent:ve},data(){return{showHistory:!0,title:"Minha carteira",perfil:null,sales_history:null}},async mounted(){try{await this.getPerfilCliente()}catch(e){console.error(e)}},methods:{changePage(e){e?this.title="Transfer\xEAncia":this.title="Minha carteira",this.showHistory=!e},async getToken(){return localStorage.getItem("token")},async getPerfilCliente(){try{const e=await this.getToken(),o={"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${e}`},n=await fetch("/api/profile",{method:"GET",headers:o});if(!n.ok)throw new Error("Network response was not ok");const r=await n.json();this.perfil=r.user,this.sales_history=r.sales_history}catch(e){console.error(e)}},formatPrice(e){return e.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})},groupedSales(e){const o={};return e.forEach(n=>{const r=new Date(n.created_at).toLocaleDateString();o[r]||(o[r]=[]),o[r].push(n)}),o},calculateTotalPrice(e){return e.reduce((o,n)=>o+parseFloat(n.bought_by),0).toFixed(2)},calculatePercentage(e){return(e*.3).toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2})}}},Ce={class:"container"},be={class:"historic"},Pe={class:"title"},xe={key:0,class:"flex wallet-info"},$e={class:"flex"},ke=t("p",{class:"label"},"Saldo dispon\xEDvel:",-1),we={class:"available-balance info"},Te={class:"flex"},Be=t("p",{class:"label"},"Valor pago a Pontea:",-1),De={class:"amount-paid info"},Ve={class:"flex"},Fe=t("p",{class:"label"},"Conta do Educador:",-1),Ie={class:"educator-account info"},qe={key:1,class:"title"},Ne={key:2},Ee={key:3},He={key:1,class:"bottom"};function Re(e,o,n,r,s,i){const u=m("ProfileComponent"),_=m("BalanceComponent"),B=m("TransactionCard"),D=m("TransferComponent");return a(),c("div",Ce,[s.perfil?(a(),F(u,{key:0,showBtn:!1,user:s.perfil},null,8,["user"])):d("",!0),t("div",be,[t("h3",Pe,l(s.title),1),s.perfil?(a(),c("section",xe,[t("div",$e,[ke,t("span",we,"R$ "+l(i.formatPrice(s.perfil.credit)),1)]),t("div",Te,[Be,t("span",De,"R$ "+l(i.calculatePercentage(s.perfil.credit)),1)]),t("div",Ve,[Fe,t("span",Ie,l(s.perfil.email_verified_at?"Verificada":"N\xE3o Verificada"),1)])])):d("",!0),s.showHistory?(a(),c("h3",qe,"Hist\xF3rico de vendas")):d("",!0),s.showHistory&&s.sales_history&&s.sales_history.length>0?(a(),c("section",Ne,[(a(!0),c(S,null,b(i.groupedSales(s.sales_history),(y,C)=>(a(),c("div",{class:"scrollable-div margin",key:C},[p(_,{date:C,totalPrice:i.calculateTotalPrice(y)},null,8,["date","totalPrice"]),(a(!0),c(S,null,b(y,g=>(a(),c("div",{key:g.id},[p(B,{title:g.activity.title,price:g.activity.price,customer:g.user.name},null,8,["title","price","customer"])]))),128))]))),128))])):d("",!0),s.showHistory?d("",!0):(a(),c("div",Ee,[p(D)]))]),s.showHistory?(a(),c("div",He,[p(w,{class:"q-px-xl q-py-sm rounded",label:"Resgatar saldo",type:"submit",color:"primary",onClick:o[0]||(o[0]=y=>i.changePage(s.showHistory))})])):d("",!0)])}var We=h(Se,[["render",Re]]);export{We as default};
